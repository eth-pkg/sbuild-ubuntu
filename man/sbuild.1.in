.\" Copyright © 1998       James Troup <james@nocrew.org>
.\" Copyright © 2005-2009  Roger Leigh <rleigh@debian.org>
.\" Copyright © 2008       Simon McVittie <smcv@debian.org>
.\"
.\" This program is free software: you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation, either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" This program is distributed in the hope that it will be useful, but
.\" WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
.\" General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program.  If not, see
.\" <http://www.gnu.org/licenses/>.
.TH SBUILD 1 "@RELEASE_DATE@" "Version @VERSION@" "Debian sbuild"
.SH NAME
sbuild \- build debian packages from source
.SH SYNOPSIS
.B sbuild
.RB [ \-h \[or] \-\-help " \[or] " \-V \[or] \-\-version ]
.RB [ \-v \[or] \-\-verbose " \[or] " \-q \[or] \-\-quiet ]
.RB [ \-D \[or] \-\-debug ]
.RB [ \-A \[or] \-\-arch\-all ]
.RB [ \-\-archive=\fIarchive\fP ]
.RB [ \-d \[or] \-\-dist=\fIdistribution\fP ]
.RB [ \-\-arch=\fIarchitecture\fP ]
.RB [ \-s \[or] \-\-source ]
.RB [ \-\-force\-orig\-source ]
.RB [ \-\-make\-binNMU=\fIchangelog-entry\fP ]
.RB [ \-\-binNMU=\fINMU-version\fP ]
.RB [ \-\-append\-to\-version=\fIstring\fP ]
.RB [ \-\-add-depends=\fIdependency\fP ]
.RB [ \-\-add-conflicts=\fIdependency\fP ]
.RB [ \-\-add-depends\-indep=\fIdependency\fP ]
.RB [ \-\-add-conflicts\-indep=\fIdependency\fP ]
.RB [ \-m \[or] \-\-maintainer=\fImaintainer\fP ]
.RB [ \-e \[or] \-\-uploader=\fIuploader\fP ]
.RB [ \-k \[or] \-\-keyid=\fIkey-id\fP ]
.RB [ \-\-debbuildopt=\fIoption\fP ]
.RB [ \-\-debbuildopts=\fIoptions\fP ]
.RB [ \-p \[or] \-\-purge=\fPpurge-mode\fP ]
.RB [ \-\-purge\-deps=\fPpurge-mode\fP ]
.RB [ \-b \[or] \-\-batch]
.RB [ \-n \[or] \-\-nolog ]
.RB [ \-\-setup\-hook=\fIhook-script\fP ]
.RB [ \-\-build\-dep\-resolver=\fIresolver\fP ]
.BR PACKAGE1_VERSION[.dsc] " [" PACKAGE2_VERSION[.dsc] " [" PACKAGE\f[BI]n\fP_VERSION[.dsc] ]]
.SH VERSION
This man page documents the packaged version of sbuild.  This version
is maintained by the \fBbuildd-tools\fP project developers on Alioth
(\f[CR]https://alioth.debian.org/projects/buildd\-tools/\fP).
.PP
There is also a version maintained by Ryan Murray which is adapted to build
daemon needs, with similar functionality.  This version should be equally
capable of working in a buildd setup, but has a number of enhancements aimed at
making it suitable for use by end-users.
.SH DESCRIPTION
\fBsbuild\fR rebuilds Debian binary packages from the corresponding
Debian source.  It is similar to dbuild and debbuild, but, unlike
them, it knows about source dependencies.
.PP
\fBsbuild\fR can fetch the Debian source over a network, or it can use
locally available sources.
.PP
\fBsbuild\fR mails the build logs to a user.  It is configured by the
configuration files \fI/etc/sbuild/sbuild.conf\fP and \fI~/.sbuildrc\fP.  An
example sbuildrc is available in
\fI/usr/share/doc/sbuild/examples/example.sbuildrc\fP.  \fBsbuild\fR will
\fBnot\fP run without a valid \fI~/.sbuildrc\fP.
.PP
Optionally, source dependencies are read from
\fI/var/lib/sbuild/source\-dependencies\-*\fP; see that file for more
information on source-dependencies.  Also see README.Debian.
.PP
You can build either using a local package with its .dsc file or a
remote one by specifying an explicit dpkg version.
.PP
Note: \fBsbuild\fR must be run in the directory (\fI~/build\fP by default) with
the chroot\-{stable,testing,unstable} symlink to the chroot or it will do the
build in the base install which is not what you want.  When using schroot,
these requirements do not apply. If the \-c or \-\-chroot option is used, the
specified chroot will be used. Otherwise, the chroot having the name (or alias) 
of the specified distribution will be used; schroot uses a chroot named
\fI$distribution\-$arch-sbuild\fP, \fI$distribution\-sbuild\fP,
\fI$distribution\-$arch\fP or \fI$distribution\fP, in that order of preference.
.SH OPTIONS
.TP
.BR \-h ", " \-\-help
Display this manual.
.TP
.BR \-V ", " \-\-version
Print version information.
.TP
.BR "\-\-add\-depends=\fIdependency\fP"
.TP
.BR "\-\-add\-conflicts=\fIdependency\fP"
.TP
.BR "\-\-add\-depends\-indep=\fIdependency\fP"
.TP
.BR "\-\-add\-conflicts\-indep=\fIdependency\fP"
These options add a build dependencies to the source package being built, in
addition to the build dependency information specified in debian/control.
These dependencies will be concatenated directly to the Build-Depends,
Build-Conflicts, Build-Depends-Indep and Build-Conflicts-Indep dependencies,
respectively.  The options may be used any number of times to add multiple
dependencies.  The format is identical to the format used in debian/control.
.TP
.BR "\-\-arch=\fIarchitecture\fP"
Build using the architecture specified.  A chroot named
\fI$distribution\-$arch-sbuild\fP or \fI$distribution\-arch\fP is searched for,
in that order of preference.  The chroot must be installed and configured
appropriately to build as that architecture, e.g. using
\fIpersonality=linux32\fP to build i386 packages on an amd64 system.
.TP
.BR \-A ", " "\-\-arch\-all"
Also build Architecture: all packages, i.e. use dpkg\-buildpackage \-b
instead of \-B.
.TP
.BR \-b ", " "\-\-batch"
Operate in batchmode, i.e. write a build-progress file during execution
and files on shutdown to facilitate a clean restart.
.TP
.BR \-c ", " "\-\-chroot"
Use the specified chroot. If not specified, the default is the first of
\fI$distribution\-$arch\-sbuild\fP, \fI$distribution\-sbuild\fP,
\fI$distribution\-$arch\fP or \fI$distribution\fP that exists.
.TP
.BR \-C ", " "\-\-check\-depends\-algorithm=\fIalgorithm\fP"
Selects the algorithm to check for build dependencies. The default algorithm
(\[oq]first-only\[cq]) just checks the first package, even if there are
alternative dependencies available. The second algorithm
(\[oq]alternatives\[cq]) also tries to satisfy the build dependencies using
these alternatives.
.TP
.BR \-d ", " "\-\-dist=\fIdistribution\fP"
Fetch source packages from specified distribution.
.TP
.BR \-\-archive=\fIarchive\fP
Communicate with specified archive.
.TP
.BR \-D ", " "\-\-debug"
Enable debug output.
.TP
.BR "\-\-apt\-clean"
Run apt-get clean in the chroot before executing the build.
.TP
.BR "\-\-apt\-update"
Run apt-get update in the chroot before executing the build.
.TP
.BR "\-\-apt\-upgrade"
Run apt-get upgrade in the chroot before executing the build.
.TP
.BR "\-\-apt\-distupgrade"
Run apt-get distupgrade in the chroot before executing the build.
.TP
.BR \-m ", " "\-\-maintainer=\fImaintainer\fP"
Passed to dpkg\-genchanges and is used to set the Maintainer: field in
the .changes file(s).  This defaults to the DEBEMAIL environment variable if
set.
.TP
.BR \-e ", " "\-\-uploader=\fIuploader\fP"
Passed to dpkg\-genchanges and is used to set the Changed\-by: field in
the .changes file(s).
.TP
.BR \-k ", " "\-\-keyid=\fIkey-id\fP"
Passed to dpkg\-genchanges and is used to set the key to sign the .changes
file(s).  Default is not using any key.
.TP
.BR \-\-debbuildopt=\fIoption\fP
Pass the specified option directly to dpkg\-buildpackage.
.TP
.BR \-\-debbuildopts=\fIoptions\fP
Pass the specified options directly to dpkg\-buildpackage.  The options should
be separated by spaces.  If any options contain spaces, use \-\-debbuildopt
instead.
.TP
.BR "\-\-mail\-log\-to=\fIemail-address\fP"
Send the build log to the specified email address.  This overrides the
\fI$mailto\fP configuration option.
.TP
.BR \-n ", " "\-\-nolog"
Do not create a package log file in the \fI$log_dir\fP directory and no build
log file, but print everything to stdout. Also do not send any log mails.
.TP
.BR \-p ", " "\-\-purge=\fIpurge-mode\fP"
\fIpurge-mode\fR determines if the build directory will be deleted after a
build. Possible values are \fBalways\fR, \fBnever\fR, and \fBsuccessful\fR.
.TP
.BR "\-\-purge\-deps=\fIpurge-mode\fP"
\fIpurge-mode\fR determines if the build dependencies will be removed after a
build. Possible values are \fBalways\fR, \fBnever\fR, and \fBsuccessful\fR.
.TP
.BR \-s ", " "\-\-source"
Also build source package, i.e. use dpkg\-buildpackage without \-B.
.TP
.BR "\-\-no-source"
Don't build source package, i.e. use dpkg\-buildpackage with \-B.  This option
is the opposite of \-\-source.
.TP
.BR "\-\-force\-orig\-source"
When used with in conjunction with \-s, this option forces the inclusion of the
orig.tar.gz file in the generated .changes file, even in cases where it would
not normally be included, i.e. use dpkg\-buildpackage \-sa.
.TP
.BR "\-\-use\-snapshot"
Installs the latest snapshot gcc compiler from the \fIgcc-snapshot\fP package,
and alters the build environment to use the snapshot compiler for the build.
.TP
.BR \-v ", " "\-\-verbose"
Be verbose, i.e. all information goes to stdout as well as to the log files.
.TP
.BR \-q ", " "\-\-quiet"
Be quiet.  This is the opposite of \-\-verbose.
.TP
.BR "\-\-make\-binNMU=\fIchangelog-entry\fP"
With this option, \fBsbuild\fR will create a new changelog entry in
debian/changelog of every package built. The version number will be in the
format for binary-only NMUs (see \-\-binNMU); the maintainer is set to the
maintainer name configured for \fBsbuild\fR. \fIchangelog-entry\fR will be used
as the changelog entry following \[lq]Binary-only non-maintainer upload for
ARCH -- no source changes\[rq]. Please note that the versions in the
\fIPACKAGE_VERSION[.dsc]\fR arguments still have to be the unmodified (non-NMU
ones) so that the sources can be found. The version number in log files and
mails will be modified by \fBsbuild\fR automatically.
.TP
.BR "\-\-binNMU=\fINMU-version\fP"
The version number of the binary NMU.  This should be used in conjunction with
\-\-make\-binNMU.  \fIversion\fP is a single number for the (+b\fIn\fR) format
used for binary NMUs.
.TP
.BR "\-\-append\-to\-version=\fIstring\fP"
This option is similar to --make-binNMU except that it allows the user to
specify an arbitrary string to be appended to the version number (immediately
before the '+' in the Debian revision if --make-binNMU is also provided).
.TP
.BR "\-\-setup\-hook=\fIhook-script\fP"
Run the specified script inside the chroot before building.  This script may
perform any required actions to customise or configure the chroot.  Note that
the script will be run inside the chroot, and so the script must exist inside
the chroot rather than the host system.
.TP
.BR "\-\-build\-dep\-resolver=\fIresolver\fP"
Use the specified resolver to handle selecting the build dependencies.
Supported resolvers are \fIinternal\fP (the default) and \fIaptitude\fP.  The
latter tries to be smarter but is also slower.  It may be of some help when
trying to pull build dependencies from an extra suite, like \fIexperimental\fP.
.SH ENVIRONMENT VARIABLES
The following environment variables are used by \fBsbuild\fR:
.IP "DEBEMAIL"
The maintainer name of the user.
.IP "HOME"
The home directory of the user.
.IP "LOGNAME"
Used in lockfiles.
.IP "sourcebase"
A URL for a Debian source distribution; generated by sbuild for scripts in
source-dependencies.
.IP "binarybase"
A URL for a Debian binary distribution; generated by sbuild for scripts in
source-dependencies.
.SH FILES
.TP
.I /etc/sbuild/sbuild.conf
Configuration, maintained by the system administrator.  This may be used to
override the defaults.
.TP
.I /etc/sbuild/chroot
Directory containing symbolic links to chroots.  This is only used for sudo
chroot access; schroot access uses the schroot chroot configuration.
.TP
.I ~/.sbuildrc
User-specific configuration.
.TP
.I /var/lib/sbuild
Build statistics, source dependencies and lock files.
.SH AUTHORS
Roman Hodek <Roman.Hodek@informatik.uni\-erlangen.de>.
.PP
\fBsbuild\fR is based on debbuild, written by James Troup
<james@nocrew.org> and has been modified by
.nf
Ben Collins <bcollins@debian.org>,
Ryan Murray <rmurray@debian.org>,
Francesco Paolo Lovergine <frankie@debian.org>,
Michael Banck <mbanck@debian.org>, and
Roger Leigh <rleigh@debian.org>
.fi
.SH COPYRIGHT
.nf
Copyright \[co] 1998-2000 Roman Hodek <roman\@hodek.net>
Copyright \[co] 1998-1999 James Troup <troup\@debian.org>
Copyright \[co] 2003-2006 Ryan Murray <rmurray\@debian.org>
Copyright \[co] 2001-2003 Rick Younie <younie\@debian.org>
Copyright \[co] 2003-2004 Francesco Paolo Lovergine <frankie\@debian.org>
Copyright \[co] 2005      Michael Banck <mbanck\@debian.org>
Copyright \[co] 2005-2009 Roger Leigh <rleigh\@debian.org>
.fi
.SH "SEE ALSO"
.BR sbuild\-abort (1),
.BR sbuild\-adduser (8),
.BR sbuild\-apt (1),
.BR sbuild\-checkpackages (1),
.BR sbuild\-createchroot (8),
.BR sbuild\-distupgrade (1),
.BR sbuild\-hold (1),
.BR sbuild\-setup (7).
.BR sbuild\-shell (1),
.BR sbuild\-stats (1),
.BR sbuild\-unhold (1),
.BR sbuild\-update (1),
.BR sbuild\-upgrade (1),
.BR schroot (1),
.\"#
.\"# The following sets edit modes for GNU EMACS
.\"# Local Variables:
.\"# mode:nroff
.\"# fill-column:79
.\"# End:
